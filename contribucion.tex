\section{Validación de hipótesis}
\label{conclu:hipotesis}

El algoritmo propuesto ha cumplido con los objetivos que se habían enunciado en la sección \ref{intro:objetivos}. Se ha diseñado un cauce de animación esqueletal que permite transformar interactivamente los modelos anatómicos de pacientes virtuales, los cuales originalmente se encuentran en una postura diferente a la posición necesaria para el entrenamiento de un determinado procedimiento médico. A su vez, el cauce permite deformar la anatomía aunque los modelos estén incompletos o falten sus descripciones mecánicas. Aunque no se ha podido realizar una evaluación formal de la \emph{suite} \ac{ITGVPH}, esta si contaba con el visto bueno de los médicos implicados en el proyecto \ac{RASimAs}.
%\todo{explica que contaba con el visto bueno del los medicos implicados en tel proyecoto}
%en el segundo caso de uso si ha sido posible. 
En el segundo caso de uso, si ha sido posible su evaluación formal.
\todo{Reescribe la parte comentada en otra frase.}
El algoritmo propuesto forma parte del simulador de radiología diagnóstica exige que la adaptación del paciente virtual sea plausible a la vez que se obtiene una imagen radiográfica al instante.
%Este segundo caso de uso representa una exigencia mayor al tener que compartir la deformación producida con otra librería manteniendo las tasas de refresco interactivas.
La validación de apariencia y de contenido realizada para el simulador %de radiología diagnóstica 
permite asegurar que el algoritmo proporciona deformaciones útiles para el entrenamiento de las proyecciones radiológicas.
Esto induce a pensar que se pueden utilizar enfoques geométricos para el entrenamiento de procedimientos médicos.

Considerando esto último, se puede afirmar positivamente que se ha validado la hipótesis de partida.




\section{Contribuciones}
\subsection{Contribuciones científicas}
\label{conclu:cientifica}

\textbf{Congreso nacional } \emph{``An Interactive Algorithm for Virtual Patient Positioning"} \cite{ceig.20151197} presentando en Congreso Español de Informática Gráfica en 2015. 

La primera contribución fue presentar una versión inicial del algoritmo en un congreso nacional. El objetivo era la adaptación del cauce clásico de animación esqueletal a modelos volumétricos. En esta publicación, la técnica de \emph{skinning} utilizada es \ac{DQS} que, aunque es una alternativa popular a la técnica \ac{LBS}, generaba incrementos de volumen que no eran útiles para utilizarlos en entrenamiento médico. De esta manera se introdujo un proceso de optimización no interactivo a cambio de mejorar la calidad del resultado. Mientras se trabajaba en las distintas integraciones del algoritmo en los casos de uso presentado, se buscó alternativas a la técnica \ac{DQS}.

\textbf{Artículo científico }\emph{``Real-time animation of human characters' anatomy"}\cite{SUJAR2018268} presentando en la revista Computer \& Graphics en 2018. 

\todo{Paper EG y el paper pendiente de publicacion.}

Como contribución principal del esta tesis, se presentó un artículo en una revista impactada en el que se presentaba el algoritmo propuesto. Como se ha descrito en los resultados del capítulo (sec. \ref{posing:result}), la solución propuesta al utilizar \ac{COR} podría reemplazar la fase de optimización con la consecución de que la herramienta permita deformaciones útiles para el entrenamiento médico interactivamente.

\textbf{ Congreso Internacional }\emph{``A Virtual Physiological Human Model for Regional Anaesthesia"}\cite{VHZKLBSGSD16} presentado en la conferencia Virtual Physiological Human (VPH) en 2016.

Este artículo representa la propuesta de los objetivos de la \emph{suite} \ac{ITGVPH} o dentro del proyecto \ac{RASimAs}. La idea principal era crear un conjunto de herramientas que permita crear una base de datos que contenga multitud de variaciones anatómicas. En este conjunto se ha integrado el algoritmo propuesto a través de la herramienta \ac{TPTVPH} que permitía la adaptación del paciente virtual a la postura requerida por el simulador. Se publicó inicialmente esta publicación en el congreso \emph{ Virtual Physiological Human (VPH)} como introducción a las demás publicaciones relacionadas con el proyecto \ac{RASimAs}. Lamentablemente, debido a los problemas para realizar la validación del simulador junto con la finalización del proyecto, han  impedido seguir en esta línea. %Tampoco ha sido posible publicar  hasta que el simulador haya pasado su validación clínica.

\textbf{ Congreso Internacional }\emph{``gVirtualXRay: Virtual X-Ray Imaging Library on GPU"}\cite{sujar:hal} presentando en el congreso Computer Graphics and Visual Computing en 2017.

Esta contribución surge como colaboración con \emph{Franck P. Vidal} \cite{gVirtualXRay}, el cual dirige un proyecto de simulación de rayos X \emph{gVirtualXRay}. Esta colaboración dio lugar al segundo caso de uso de esta tesis. En este artículo, se presentó las posibilidades de la librería de \emph{gVirtualXRay} para ser utilizada como simulador de radiología que será finalmente completada con la publicación del artículo en progreso llamado: \emph{``Interactive learning environment for diagnostic radiographywith real-time X-ray simulation and patient positioning"} con intención de ser publicado en la revista impactada Computerized Medical Imaging and Graphics en un futuro cercano. Se puede consultar un manuscrito en el anexo \ref{anexo:xray}.







\subsection{Contribuciones técnicas}
\label{conclu:tecnica}

%Our technical contributions can be summarised as follow:

%Las contribuciones tecnicas son los simuladores y las herramientas. 1. Herramienta de poses. Integración en el sistema de generación de pacientes virtuales. 2. cOURWARE DE RASIMAS. 3. Colaboraste en la integración de RASim. Propuesta de prototipo sin haptico que si conto con un opinon positiva de los medicos (!!!). Di que reescribiste los drivers del haptico

%4. Simulador de rayos x: Sistema de pose, integracion con el simulador del rayos x, courseware.

\todo{Aqui no hables de paper. Habla de herramientas desarrolladas, librerias: Libreria de posing, integradada con GMRVGL (libreria de render desarrollada en el grupo), herramienta de posing. Integracion de la herramienta de creacion de pacientes virtuales. Integración de RASim. Adapatacion del prototipo a Flockof birds (has reescrito los drivers). Herramienta de radiologia diagnostica.}

\textbf{ Sistema } Librería de posicionamiento de pacientes virtuales.

A partir de la librería de \emph{render} \emph{GMRVGL} desarrollada por el grupo de investigación \ac{GMRV} de la \ac{URJC}, se desarrolló el cauce del algoritmo propuesto. Se desarrolló una \ac{IU} que permite al usuario adaptar la posición de manera sencilla, dando lugar también a la herramienta \ac{TPTVPH} que se incorporó en la \emph{suite} \ac{ITGVPH}.

\textbf{ Sistema } Courseware de \ac{RASim}

Se ha desarrollado una aplicación de autoevaluación y aprendizaje del procedimiento de \ac{RA}. Esta aplicación dirige al usuario a través del procedimiento, mientras coordina todos los módulos del simulador en función del tipo de entrenamiento. Debido a esto, se ha colaborado activamente en la integración del prototipo \ac{RASim}.

\textbf{ Sistema } Controlador \emph{Flock of birds} 

Con el objetivo de proponer una solución alternativa a los dispositivos hápticos defectuosos, se propuso la utilización de \acs{tracker}s magnéticos. El único dispositivo disponible en la \ac{URJC} era el \emph{Flock of birds}, el cual no contaba con soporte para sistemas operativos modernos. Se reimplementó los controladores de este dispositivo para poder comunicarse con el módulo \emph{H3D} encargado de la comunicación de los dispositivos y su representación en la escena virtual.


\textbf{ Sistema } Simulador de radiología diagnóstica

Junto con la librería de posicionamiento de paciente virtuales y la librería \emph{gVirtualXRay} se ha desarrollado un simulador de radiología diagnóstica que permite a estudiantes y profesores conseguir la radiografía de un paciente virtual mientras seleccionan la postura adecuada. Se trabajo conjuntamente con el Dr. Franck P. Vidal para incorporar las modificaciones necesarias en \emph{gVirtualXRay} para compartir la memoria en \acs{GPU}. 





%\todo{Mete como contribucion cientifica el ultimo paper, ponlo como apendice y di que está pendiente de publicar. }


\section{Limitaciones y líneas futuras}
\label{conclu:future}

\subsection{Algoritmo de posicionamiento de pacientes virtuales}

La principal limitación que presenta el algoritmo de posicionamiento de pacientes virtuales es la utilización de un enfoque geométrico. Como tal, los resultados que proporcionan son heurísticos y no físicamente correctos. Esta característica impide que pueda emplearse para planificación quirúrgica o en aquellos lugares que necesiten un comportamiento fiel a la realidad. Por ejemplo, no se tienen en cuenta efectos como la gravedad en los tejidos internos, lo cual generaría transformaciones en los tejidos anatómicos diferentes si el paciente virtual se encontrara de pie o tumbado.

Por último, se han identificado las siguientes limitaciones:
\begin{itemize}
    \item Las estructuras mínimas que necesita el algoritmo son la piel y los huesos. Estos tejidos son los más habituales que se pueden capturar en muchas de las imágenes médicas, por tanto, servirán para guiar el proceso e identificar algunos puntos claves para el correcto funcionamiento del algoritmo.
    
    \item Debido a que la extracción de los tejidos desde imágenes médicas no es perfecta, se permiten que haya auto colisiones y colisiones entre tejidos. Aun así, se espera que los diferentes tejidos anatómicos no sobresalgan de la piel, ya que el algoritmo no está diseñado para resolver colisiones, además de no generar colisiones adicionales. Aunque aquellos tejidos que traspasen la piel son irreales, se tratarán por igual aunque no se puede asegurar una deformación realista.
    
    \item El algoritmo utilizará un esqueleto virtual para definir los movimientos de las articulaciones. Se utilizará la información que proporciona los tejidos óseos para construir un esqueleto virtual adecuado al modelo de entrada. La principal limitación es la selección manual de las zonas identificadas que se necesitan para identificar los puntos de rotación de la articulación y su sistema de referencia.
\end{itemize}

Aún así, los resultados obtenidos son lo suficientemente plausibles para proporcionar un método que consiga generar modelos anatómicos en el contexto de entrenamiento médico.

Se puede destacar que el diseño seguido del cauce de animación esqueletal permite actualizar los algoritmos utilizados en cada etapa independientemente. En el futuro pueden sustituirse etapas por nuevos métodos que permitan mejorar los resultados. 

Por ejemplo, en la etapa de \emph{rigging} se podría desarrollar un método que se pudiera extrajera el esqueleto virtual automáticamente basándose en el tejido óseo del paciente virtual, basándose en el trabajo de \cite{Tagliasacchi}.

En cuanto la etapa de pesado, se podría analizar si la incorporación de técnicas de pesado más complejas como
\cite{Jacobson:2011} ofrecen mejores resultados.

Un objetivo para mejorar la calidad de los modelos anatómicos generados es la Una técnica que pueda solucionar autocolisiones \cite{Vaillant:2014}

En la selección de poses, la técnica de cinemática inversa \cite{Shi:2007} se podría añadir de manera trivial para mejorar la interacción del usuario con el sistema, o ayudar al posicionamiento del paciente si se incorporarán movimientos de las articulaciones más complejos que simples rotaciones \cite{joints}.

Incluso, se podría incorporar nuevos métodos basados en física como los prometedores métodos  \emph{Point-Based Dynamics}  \cite{abu2015position} que permitan animación en tiempos interactivos y la caracterización mecánica de los tetraedros.




\subsection{RASimAs}

Aunque el proyecto \ac{RASimAs} se completó de manera favorable, la falta de validación clínica es un requisito fundamental para la publicación de resultados. Aunque los distintos módulos han sido evaluados por parte de los médicos y el prototipo  ha obtenido una validez de contenido, la finalización del proyecto y la falta de fondos han hecho imposible la realización de más validaciones de constructo, concurrente y predictiva en un entorno clínico.  %Se espera poder solucionar los defectos que presentan los dispositivos o incorporar otros diferentes con el fin de poder llevar el simulador a los entornos clínicos.


Además, este entorno se podría adaptar a otro tipo de procedimientos médicos. El módulo \ac{Courseware} esta diseñado como una maquina de estados y las ayudas de usuario desarrolladas pueden ser útiles para otro tipo de procedimientos. Aun así, se tendría que generar nuevo  contenido de ayuda especifico del procedimiento médico, además de definir nuevas métricas interesantes para ese entrenamiento.

Por último hay que destacar que en \ac{RASim} no se tienen en cuenta algunos procedimientos protocolarios. La preparación de la sala o instrumental médico son aspectos importantes del procedimiento, lo cual se podría incorporar mediante interacción del usuario con el escenario virtual. Otro aspecto fundamental del procedimiento es la técnica aséptica o la aplicación del gel para la sonda de \ac{US}. Como primera opción, podría implementarse un efecto de pintado en la piel del paciente virtual utilizando los propios dispositivos del simulador. 


\subsection{Simulador de radiología diagnóstica}

Aunque la aplicación se ha diseñado para satisfacer las necesidades de los radiólogos, presenta ciertas limitaciones respecto al procedimiento de diagnóstico por imagen. Existen cuestiones relacionadas con la preparación del paciente para el procedimiento que no pueden ser cubiertas por el simulador, que se pueden ver a continuación:

\begin{itemize}
    \item Se recomienda utilizar un lenguaje apropiado y efectivo en la comunicación con los pacientes que no es posible recoger por el simulador.
    \item No se representa la necesidad de indicar al paciente acerca de quitarse prendas u objetos que afecten al área de examen.
    \item No se practican las recomendaciones en cuanto al uso de protectores de plomo para pacientes y profesionales.
    \item Otras comprobaciones que implican condiciones médicas o protocolarias como embarazo, identificación del paciente, etcétera.
\end{itemize}
Podría valorarse incluir una serie de preguntas a cerca de un informe médico creado para el paciente virtual, o incluir un reconocimiento de voz para practicar el lenguaje utilizado. 

Además, el simulador cuenta con las limitaciones propias de los módulos por los que esta compuesto. Todas las mejoras introducidas en el algoritmo propuesto que tengan relación con la calidad de las transformaciones, serán beneficiosas para conseguir imágenes anatómicamente correctas. Por ejemplo, el tratamiento de las autocolisiones o la diferencia de los tejidos según el paciente virtual se encuentre de pie o en décubito.


Por otra parte, se encuentran las propias limitaciones de la librería \emph{gVirtualXRay}. La configuración de la intensidad \acs{mAs} de la máquina de rayos X no está incorporada en el sistema, y es un parámetro importante para los radiólogos con el fin de mejorar la calidad de la radiografía.

Para aumentar la cantidad de pacientes virtuales disponibles para la herramienta, se podría actualizar la librería para incorporar la funcionalidad de producir radiografías con modelos volumétricos, representaciones que el algoritmo propuesto si puede manejar.

Otra funcionalidad extra que se podría incluir en el simulador, es la medición de la dosis recibida por el paciente. Existen actualmente simuladores de dosis y calculadoras \emph{online} \cite{xraydose}, que podrían ser incorporadas al simulador. De la misma manera, es posible incorporar otras técnicas de imagen médica que puedan ser simuladas. Se podría ampliar el abanico de tecnologías de diagnóstico por imagen (p. ej. \acs{IRM}, \acs{US} o \acs{TC}) que requieran posicionar al paciente virtual obteniendo una imagen médica al instante, lo cual podría derivar en una nueva línea de investigación.










